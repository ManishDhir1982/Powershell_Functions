param (
[parameter(Mandatory=$true)]
[string] $str_User_Name,
[parameter(Mandatory=$true)]
[string] $str_User_Right,
[parameter(Mandatory=$true)]
[string] $str_Right_Inheritance,
[parameter(Mandatory=$true)]
[string] $str_Right_Propogation,
[parameter(Mandatory=$true)]
[string] $str_Right_Type,

[parameter(Mandatory=$false)]
[string] $str_Custom_Log_File_Name_Path,

[switch] $swt_ConsoleMessage
)

$str_Error_Message = ""
$str_Default_Log_File_Name_Path = "$env:USERPROFILE\Desktop\"+($MyInvocation.MyCommand.Name).Replace(".ps1","_log.txt")

if ($str_Custom_Log_File_Name_Path -ne "") {
    $str_Default_Log_File_Name_Path = $str_Custom_Log_File_Name_Path
}

<#
# Create the ACE
$identity = 'domain\user'
$rights = 'FullControl' #Other options: [enum]::GetValues('System.Security.AccessControl.FileSystemRights')
$inheritance = 'ContainerInherit, ObjectInherit' #Other options: [enum]::GetValues('System.Security.AccessControl.Inheritance')
$propagation = 'None' #Other options: [enum]::GetValues('System.Security.AccessControl.PropagationFlags')
$type = 'Allow' #Other options: [enum]::GetValues('System.Securit y.AccessControl.AccessControlType')
#>

try {
    $ACE = New-Object System.Security.AccessControl.FileSystemAccessRule($str_User_Name, `
                                                $str_User_Right, `
                                                $str_Right_Inheritance, `
                                                $str_Right_Propogation, $str_Right_Type) -ErrorAction Stop

    if ($swt_ConsoleMessage) {
        Write-Host "Access Control Entry Created Successful" -ForegroundColor Green
    }
} catch {
    $dt_Current_Date = Get-Date
    $str_Error_Message = "$dt_Current_Date | Line# " + $Error[0].InvocationInfo.ScriptLineNumber + " | " + $Error[0].Exception.Message
    $str_Error_Message | Add-Content -Path $str_Default_Log_File_Name_Path -Force
    $ACE = $false
    if ($swt_ConsoleMessage) {
        Write-Host $str_Error_Message -ForegroundColor Red
    }
}

return $ACE
